<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VSF Documented: 名词定义</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VSF Documented
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li class="current"><a href="pages.html"><span>相关页面</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="namespaces.html"><span>命名空间</span></a></li>
      <li><a href="annotated.html"><span>结构体</span></a></li>
      <li><a href="files.html"><span>文件</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">名词定义</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a>什么是 被测设备 和 辅助设备 ？</p>
<h1><a class="anchor" id="autotoc_md1"></a>
被测设备</h1>
<p>用户希望在某块开发板上测试外设驱动/组件模块等等，那么这块开发板就叫做**被测设备**。</p>
<h1><a class="anchor" id="autotoc_md2"></a>
辅助设备</h1>
<p>为了测试这块开发板的某个功能，例如 <b>UART**，需要有另外一个硬件提供 **UART</b> 用来接收或者发送数据。 我们把这个硬件叫做**辅助设备**。**辅助设备**可能是另外一块开发板或者 PC 。</p>
<h1><a class="anchor" id="autotoc_md3"></a>
VSF Test 架构</h1>
<p>嵌入式环境通常缺少一个相对可靠的环境进行各种测试。本模块尝试去提供一个测试框架来处理测试需求。</p>
<p>使用其他现成测试框架遇到问题是，如果测试的时候出现异常（包括进入异常，卡死在各种循环里），但是测试框架没法正确处理它。 因此为了保证可靠的测试，我们还需要通过硬件来提供一些功能。</p>
<p>我们使用看门狗提供超时复位，可以确保在测试异常停止测试用例，复位之后可以继续进行下一个测试。 因为看门狗可能随时复位，所以我们还需要实现数据持久化功能，确保测试时的数据不会丢失。</p>
<p>有了上面的这些硬件机制之后，我们可以提供一个适合嵌入式的测试框架，它在被测设备里直接运行。又因为由辅助设备，所以对被测设备的要求非常低。</p>
<p>我们通常使用由辅助设备完成持久化功能，被测设备仅仅需要发送对应的数据。所以被测设备需要提供一个测试串口和看门狗。 如果没法提供串口，也可以考虑通过JTAG/SWD接口（目前还没有对接）。如果被测设备没有看门狗，那么要求辅助设备可以控制被测设备的电源。</p>
<h1><a class="anchor" id="autotoc_md4"></a>
实现</h1>
<p>辅助设备应该包含了这些信息：</p><ul>
<li>提供了和**被测设备**通信的接口<ul>
<li>目前辅助设备仅有在 PC 上基于 Python 实现 UART</li>
<li>TODO: 使用另外一块硬件开发板实现</li>
<li>TODO: 使用其他外设（JTAG/SWD)</li>
</ul>
</li>
<li>辅助设备通过解析被测设备发送的命令保存数据，已经定义的命令有：<ul>
<li>testcase_index<ul>
<li>第二个参数是read或者write，如果是write的时候第三个参数是更新后的序号</li>
<li>被测设备通过查询序号避免复位之后重复测试</li>
</ul>
</li>
<li>testcase_status<ul>
<li>第二个参数是read或者write，如果是write的时候第三个参数是更新后的状态</li>
<li>被测设备查询当前测试的状态，1 表示测试开始，0 表示测试还没。被测设备通过读取这个 key 来判断是否进行过复位。</li>
</ul>
</li>
<li>testcase_result ：<ul>
<li>被测设备写入被测设备侧的测试结果, 辅助设备不需要回应</li>
<li>第二个参数是 testcase 序号</li>
<li>第三个参数是 该 testcase 的结果（0： pass， 1: skip, 2-N : faild）</li>
<li>如果有第四个或者更多参数，都是错误信息</li>
</ul>
</li>
<li>testcase_request<ul>
<li>被测设备请求进行测试，辅助设备根据请求信息判断是否可以完成测试，如果可以则辅助设备回复 "1\n"，不可以则返回 "0\n"</li>
<li>第二个参数是测试的名字</li>
<li>如果有第3~N个参数，都是测试请求的参数</li>
<li>目前还没有针对各种测试设定好标准测试参数</li>
</ul>
</li>
<li>testcase_all_done<ul>
<li>被测设备表示所有测试都完成了，辅助设备不需要回应，这时候可以输出测试报告</li>
</ul>
</li>
<li>external_watch_init<ul>
<li>被测设备请求模拟看门狗初始化，第二个参数是看门狗超时时间（毫秒）</li>
</ul>
</li>
<li>external_watch_feed<ul>
<li>模拟看门狗喂狗</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a class="el" href="vsf__test__assist_8py.html">vsf_test_assist.py</a> 提供了一个简单的基于 PC 的辅助设备的实现 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div style="text-align: center; font-size: small; margin-top: 20px;">
  由提交
  <a href="https://github.com/vsfteam/vsf/commit/8a1b48c0fc7ba71495dc3501516b87534b033a4c" target="_blank">vsfteam/vsf@8a1b48c</a>
  生成
</div>